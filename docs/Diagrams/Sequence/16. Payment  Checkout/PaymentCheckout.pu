@startuml
title UC-16 Payment / Checkout (Sequence)
participant User
participant WebApp
participant PaymentService
participant PaymentGateway
participant DB
participant NotificationService

User -> WebApp: proceed to checkout & confirm payment
WebApp -> PaymentService: createPayment(userId, items)
PaymentService -> DB: INSERT payment(status=PENDING)
DB --> PaymentService: paymentId
PaymentService -> PaymentGateway: initiateTransaction(paymentId, amount)
PaymentGateway --> PaymentService: syncResult or redirect
alt immediate success
PaymentService -> DB: update status=SUCCESS
PaymentService -> NotificationService: sendReceipt(user)
NotificationService --> User: email/receipt
else async flow
PaymentGateway -> WebApp: redirect to gateway
PaymentGateway -> PaymentService: webhookCallback(paymentId, status)
PaymentService -> DB: update status accordingly
end
PaymentService --> WebApp: paymentResult
WebApp --> User: show result
@enduml
